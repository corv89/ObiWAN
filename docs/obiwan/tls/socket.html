<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!--  This file is generated by Nim. -->
<html xmlns="https://www.w3.org/1999/xhtml" xml:lang="en" lang="en" data-theme="auto">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>src/obiwan/tls/socket</title>

<!-- Google fonts -->
<link href='https://fonts.googleapis.com/css?family=Lato:400,600,900' rel='stylesheet' type='text/css'/>
<link href='https://fonts.googleapis.com/css?family=Source+Code+Pro:400,500,600' rel='stylesheet' type='text/css'/>

<!-- Favicon -->
<link rel="shortcut icon" href="data:image/x-icon;base64,AAABAAEAEBAAAAEAIABoBAAAFgAAACgAAAAQAAAAIAAAAAEAIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AAAAAAUAAAAF////AP///wD///8A////AP///wD///8A////AP///wD///8A////AAAAAAIAAABbAAAAlQAAAKIAAACbAAAAmwAAAKIAAACVAAAAWwAAAAL///8A////AP///wD///8A////AAAAABQAAADAAAAAYwAAAA3///8A////AP///wD///8AAAAADQAAAGMAAADAAAAAFP///wD///8A////AP///wAAAACdAAAAOv///wD///8A////AP///wD///8A////AP///wD///8AAAAAOgAAAJ3///8A////AP///wAAAAAnAAAAcP///wAAAAAoAAAASv///wD///8A////AP///wAAAABKAAAAKP///wAAAABwAAAAJ////wD///8AAAAAgQAAABwAAACIAAAAkAAAAJMAAACtAAAAFQAAABUAAACtAAAAkwAAAJAAAACIAAAAHAAAAIH///8A////AAAAAKQAAACrAAAAaP///wD///8AAAAARQAAANIAAADSAAAARf///wD///8AAAAAaAAAAKsAAACk////AAAAADMAAACcAAAAnQAAABj///8A////AP///wAAAAAYAAAAGP///wD///8A////AAAAABgAAACdAAAAnAAAADMAAAB1AAAAwwAAAP8AAADpAAAAsQAAAE4AAAAb////AP///wAAAAAbAAAATgAAALEAAADpAAAA/wAAAMMAAAB1AAAAtwAAAOkAAAD/AAAA/wAAAP8AAADvAAAA3gAAAN4AAADeAAAA3gAAAO8AAAD/AAAA/wAAAP8AAADpAAAAtwAAAGUAAAA/AAAA3wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAADfAAAAPwAAAGX///8A////AAAAAEgAAADtAAAAvwAAAL0AAADGAAAA7wAAAO8AAADGAAAAvQAAAL8AAADtAAAASP///wD///8A////AP///wD///8AAAAAO////wD///8A////AAAAAIcAAACH////AP///wD///8AAAAAO////wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A//8AAP//AAD4HwAA7/cAAN/7AAD//wAAoYUAAJ55AACf+QAAh+EAAAAAAADAAwAA4AcAAP5/AAD//wAA//8AAA=="/>
<link rel="icon" type="image/png" sizes="32x32" href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAAA3XAAAN1wFCKJt4AAAAB3RJTUUH4QQQEwksSS9ZWwAAAk1JREFUWMPtll2ITVEUx39nn/O7Y5qR8f05wtCUUr6ZIS++8pEnkZInPImneaCQ5METNdOkeFBKUhMPRIkHKfEuUZSUlGlKPN2TrgfncpvmnntnmlEyq1Z7t89/rf9a6+y99oZxGZf/XeIq61EdtgKXgdXA0xrYAvBjOIF1AI9zvjcC74BSpndrJPkBWDScTF8Aa4E3wDlgHbASaANmVqlcCnwHvgDvgVfAJ+AikAAvgfVZwLnSVZHZaOuKoQi3ZOMi4NkYkpe1p4J7A8BpYAD49hfIy/oqG0+hLomiKP2L5L+1ubn5115S+3OAn4EnwBlgMzCjyt6ZAnQCJ4A7wOs88iRJHvw50HoujuPBoCKwHWiosy8MdfZnAdcHk8dxXFJ3VQbQlCTJvRBCGdRbD4M6uc5glpY3eAihpN5S5w12diSEcCCEcKUO4ljdr15T76ur1FDDLIQQ3qv71EdDOe3Kxj3leRXyk+pxdWnFWod6Wt2bY3de3aSuUHcPBVimHs7mK9WrmeOF6lR1o9qnzskh2ar2qm1qizpfXaPeVGdlmGN5pb09qMxz1Xb1kLqgzn1RyH7JUXW52lr5e/Kqi9qpto7V1atuUzfnARrV7jEib1T76gG2qxdGmXyiekkt1GswPTtek0aBfJp6YySGBfWg2tPQ0FAYgf1stUfdmdcjarbYJEniKIq6gY/Aw+zWHAC+p2labGpqiorFYgGYCEzN7oQdQClN07O1/EfDyGgC0ALMBdYAi4FyK+4H3gLPsxfR1zRNi+NP7nH5J+QntnXe5B5mpfQAAAAASUVORK5CYII=">

<!-- CSS -->
<link rel="stylesheet" type="text/css" href="../../nimdoc.out.css?v=2.3.1">

<!-- JS -->
<script type="text/javascript" src="../../dochack.js?v=2.3.1"></script>
</head>
<body>
  <div class="document" id="documentId">
    <div class="container">
      <h1 class="title">src/obiwan/tls/socket</h1>
      <div class="row">
  <div class="three columns">
    <div class="theme-select-wrapper">
      <label for="theme-select">Theme:&nbsp;</label>
      <select id="theme-select" onchange="setTheme(this.value)">
        <option value="auto">ðŸŒ— Match OS</option>
        <option value="dark">ðŸŒ‘ Dark</option>
        <option value="light">ðŸŒ• Light</option>
      </select>
    </div>
    <div id="global-links">
      <ul class="simple">
        <li><a id="indexLink" href="../../theindex.html">Index</a></li>
      </ul>
    </div>
    <div id="searchInputDiv">
      Search: <input type="search" id="searchInput" oninput="search()"/>
    </div>
    <div>
      Group by:
      <select onchange="groupBy(this.value)">
        <option value="section">Section</option>
        <option value="type">Type</option>
      </select>
    </div>
    <ul class="simple simple-toc" id="toc-list">
  <li>
  <a class="reference reference-toplevel" href="#6" id="56">Imports</a>
</li>
<li>
  <details open>
    <summary><a class="reference reference-toplevel" href="#7" id="57">Types</a></summary>
    <ul class="simple simple-toc-section">
      <li><a class="reference" href="#BaseSslContext" title="BaseSslContext = ref object of RootObj">BaseSslContext</a></li>
<li><a class="reference" href="#MbedtlsError" title="MbedtlsError = object of CatchableError">MbedtlsError</a></li>
<li><a class="reference" href="#MbedtlsSocket" title="MbedtlsSocket = ref MbedtlsSocketObj">MbedtlsSocket</a></li>
<li><a class="reference" href="#MbedtlsSocketObj" title="MbedtlsSocketObj = object
  fd*: cint
  domain*: cint
  sslContext*: MbedtlsSslContext
  sslHandle*: ptr mbedtls.mbedtls_ssl_context">MbedtlsSocketObj</a></li>
<li><a class="reference" href="#MbedtlsSslContext" title="MbedtlsSslContext = ref object of BaseSslContext
  context*: mbedtls.mbedtls_ssl_context
  config*: mbedtls.mbedtls_ssl_config
  entropy*: mbedtls.mbedtls_entropy_context
  ctr_drbg*: mbedtls.mbedtls_ctr_drbg_context
  cacert*: mbedtls.mbedtls_x509_crt
  cert*: mbedtls.mbedtls_x509_crt
  key*: mbedtls.mbedtls_pk_context">MbedtlsSslContext</a></li>
<li><a class="reference" href="#X509Certificate" title="X509Certificate = ptr mbedtls.mbedtls_x509_crt">X509Certificate</a></li>

    </ul>
  </details>
</li>
<li>
  <details open>
    <summary><a class="reference reference-toplevel" href="#12" id="62">Procs</a></summary>
    <ul class="simple simple-toc-section">
      <ul class="simple nested-toc-section">$
  <li><a class="reference" href="#%24%2CX509Certificate" title="`$`(cert: X509Certificate): string">`$`(cert: X509Certificate): string</a></li>

</ul>
<ul class="simple nested-toc-section">close
  <li><a class="reference" href="#close%2CMbedtlsSocket" title="close(socket: MbedtlsSocket)">close(socket: MbedtlsSocket)</a></li>

</ul>
<ul class="simple nested-toc-section">commonName
  <li><a class="reference" href="#commonName%2CX509Certificate" title="commonName(cert: X509Certificate): string">commonName(cert: X509Certificate): string</a></li>

</ul>
<ul class="simple nested-toc-section">dial
  <li><a class="reference" href="#dial%2Cstring%2Cint" title="dial(address: string; port: int): MbedtlsSocket">dial(address: string; port: int): MbedtlsSocket</a></li>

</ul>
<ul class="simple nested-toc-section">fingerprint
  <li><a class="reference" href="#fingerprint%2CX509Certificate" title="fingerprint(cert: X509Certificate): string">fingerprint(cert: X509Certificate): string</a></li>

</ul>
<ul class="simple nested-toc-section">getSslHandle
  <li><a class="reference" href="#getSslHandle%2CMbedtlsSocket" title="getSslHandle(socket: MbedtlsSocket): ptr mbedtls.mbedtls_ssl_context">getSslHandle(socket: MbedtlsSocket): ptr mbedtls.mbedtls_ssl_context</a></li>

</ul>
<ul class="simple nested-toc-section">handshakeAsClient
  <li><a class="reference" href="#handshakeAsClient%2Cptr." title="handshakeAsClient(sslCtx: ptr mbedtls.mbedtls_ssl_context): cint">handshakeAsClient(sslCtx: ptr mbedtls.mbedtls_ssl_context): cint</a></li>

</ul>
<ul class="simple nested-toc-section">handshakeAsServer
  <li><a class="reference" href="#handshakeAsServer%2Cptr." title="handshakeAsServer(sslCtx: ptr mbedtls.mbedtls_ssl_context): cint">handshakeAsServer(sslCtx: ptr mbedtls.mbedtls_ssl_context): cint</a></li>

</ul>
<ul class="simple nested-toc-section">isClosed2
  <li><a class="reference" href="#isClosed2%2CMbedtlsSocket" title="isClosed2(socket: MbedtlsSocket): bool">isClosed2(socket: MbedtlsSocket): bool</a></li>

</ul>
<ul class="simple nested-toc-section">newContext
  <li><a class="reference" href="#newContext" title="newContext(): MbedtlsSslContext">newContext(): MbedtlsSslContext</a></li>

</ul>
<ul class="simple nested-toc-section">recv
  <li><a class="reference" href="#recv%2CMbedtlsSocket%2Cpointer%2Cint" title="recv(socket: MbedtlsSocket; data: pointer; size: int): int">recv(socket: MbedtlsSocket; data: pointer; size: int): int</a></li>

</ul>
<ul class="simple nested-toc-section">recvLine
  <li><a class="reference" href="#recvLine%2CMbedtlsSocket" title="recvLine(socket: MbedtlsSocket): string">recvLine(socket: MbedtlsSocket): string</a></li>

</ul>
<ul class="simple nested-toc-section">send
  <li><a class="reference" href="#send%2CMbedtlsSocket%2Cpointer%2Cint" title="send(socket: MbedtlsSocket; data: pointer; size: int): int">send(socket: MbedtlsSocket; data: pointer; size: int): int</a></li>
<li><a class="reference" href="#send%2CMbedtlsSocket%2Cstring" title="send(socket: MbedtlsSocket; data: string): int">send(socket: MbedtlsSocket; data: string): int</a></li>

</ul>
<ul class="simple nested-toc-section">setCustomVerify
  <li><a class="reference" href="#setCustomVerify%2CMbedtlsSslContext" title="setCustomVerify(context: MbedtlsSslContext)">setCustomVerify(context: MbedtlsSslContext)</a></li>

</ul>
<ul class="simple nested-toc-section">setMinVersion
  <li><a class="reference" href="#setMinVersion%2CMbedtlsSslContext%2C" title="setMinVersion(context: MbedtlsSslContext; version: mbedtls.TlsVersion): bool">setMinVersion(context: MbedtlsSslContext; version: mbedtls.TlsVersion): bool</a></li>

</ul>
<ul class="simple nested-toc-section">wrapConnectedSocket
  <li><a class="reference" href="#wrapConnectedSocket%2CMbedtlsSslContext%2CMbedtlsSocket%2Cproc%28ptr.%29%2Cstring" title="wrapConnectedSocket(context: MbedtlsSslContext; socket: MbedtlsSocket;
    handshakeFunc: proc (sslCtx: ptr mbedtls.mbedtls_ssl_context): cint;
                    hostname: string)">wrapConnectedSocket(context: MbedtlsSslContext; socket: MbedtlsSocket;
    handshakeFunc: proc (sslCtx: ptr mbedtls.mbedtls_ssl_context): cint;
                    hostname: string)</a></li>
<li><a class="reference" href="#wrapConnectedSocket%2CMbedtlsSslContext%2CMbedtlsSocketObj%2Cproc%28ptr.%29%2Cstring" title="wrapConnectedSocket(context: MbedtlsSslContext; socket: var MbedtlsSocketObj;
    handshakeFunc: proc (sslCtx: ptr mbedtls.mbedtls_ssl_context): cint;
                    hostname: string)">wrapConnectedSocket(context: MbedtlsSslContext; socket: var MbedtlsSocketObj;
    handshakeFunc: proc (sslCtx: ptr mbedtls.mbedtls_ssl_context): cint;
                    hostname: string)</a></li>

</ul>

    </ul>
  </details>
</li>

</ul>

  </div>
  <div class="nine columns" id="content">
    
    <div id="tocRoot"></div>
    
    <p class="module-desc"><p>X.509 certificate type used in TLS connections</p>
<p>This type represents an X.509 digital certificate used for authentication in TLS connections. It provides methods for extracting certificate information such as subject names and generating fingerprints.</p>
</p>
    <div class="section" id="6">
  <h1><a class="toc-backref" href="#6">Imports</a></h1>
  <dl class="item">
    <a class="reference external" href="mbedtls.html">mbedtls</a>, <a class="reference external" href="../debug.html">../debug</a>
  </dl>
</div>
<div class="section" id="7">
  <h1><a class="toc-backref" href="#7">Types</a></h1>
  <dl class="item">
    <div id="BaseSslContext">
  <dt><pre><a href="socket.html#BaseSslContext"><span class="Identifier">BaseSslContext</span></a> <span class="Other">=</span> <span class="Keyword">ref</span> <span class="Keyword">object</span> <span class="Keyword">of</span> <span class="Identifier">RootObj</span></pre></dt>
  <dd>
    
    
    
  </dd>
</div>
<div id="MbedtlsError">
  <dt><pre><a href="socket.html#MbedtlsError"><span class="Identifier">MbedtlsError</span></a> <span class="Other">=</span> <span class="Keyword">object</span> <span class="Keyword">of</span> <span class="Identifier">CatchableError</span></pre></dt>
  <dd>
    
    
    
  </dd>
</div>
<div id="MbedtlsSocket">
  <dt><pre><a href="socket.html#MbedtlsSocket"><span class="Identifier">MbedtlsSocket</span></a> <span class="Other">=</span> <span class="Keyword">ref</span> <a href="socket.html#MbedtlsSocketObj"><span class="Identifier">MbedtlsSocketObj</span></a></pre></dt>
  <dd>
    
    
    
  </dd>
</div>
<div id="MbedtlsSocketObj">
  <dt><pre><a href="socket.html#MbedtlsSocketObj"><span class="Identifier">MbedtlsSocketObj</span></a> <span class="Other">=</span> <span class="Keyword">object</span>
  <span class="Identifier">fd</span><span class="Operator">*</span><span class="Other">:</span> <span class="Identifier">cint</span>
  <span class="Identifier">domain</span><span class="Operator">*</span><span class="Other">:</span> <span class="Identifier">cint</span>
  <span class="Identifier">sslContext</span><span class="Operator">*</span><span class="Other">:</span> <a href="socket.html#MbedtlsSslContext"><span class="Identifier">MbedtlsSslContext</span></a>
  <span class="Identifier">sslHandle</span><span class="Operator">*</span><span class="Other">:</span> <span class="Keyword">ptr</span> <span class="Identifier">mbedtls</span><span class="Other">.</span><span class="Identifier">mbedtls_ssl_context</span></pre></dt>
  <dd>
    
    
    
  </dd>
</div>
<div id="MbedtlsSslContext">
  <dt><pre><a href="socket.html#MbedtlsSslContext"><span class="Identifier">MbedtlsSslContext</span></a> <span class="Other">=</span> <span class="Keyword">ref</span> <span class="Keyword">object</span> <span class="Keyword">of</span> <a href="socket.html#BaseSslContext"><span class="Identifier">BaseSslContext</span></a>
  <span class="Identifier">context</span><span class="Operator">*</span><span class="Other">:</span> <span class="Identifier">mbedtls</span><span class="Other">.</span><span class="Identifier">mbedtls_ssl_context</span>
  <span class="Identifier">config</span><span class="Operator">*</span><span class="Other">:</span> <span class="Identifier">mbedtls</span><span class="Other">.</span><span class="Identifier">mbedtls_ssl_config</span>
  <span class="Identifier">entropy</span><span class="Operator">*</span><span class="Other">:</span> <span class="Identifier">mbedtls</span><span class="Other">.</span><span class="Identifier">mbedtls_entropy_context</span>
  <span class="Identifier">ctr_drbg</span><span class="Operator">*</span><span class="Other">:</span> <span class="Identifier">mbedtls</span><span class="Other">.</span><span class="Identifier">mbedtls_ctr_drbg_context</span>
  <span class="Identifier">cacert</span><span class="Operator">*</span><span class="Other">:</span> <span class="Identifier">mbedtls</span><span class="Other">.</span><span class="Identifier">mbedtls_x509_crt</span>
  <span class="Identifier">cert</span><span class="Operator">*</span><span class="Other">:</span> <span class="Identifier">mbedtls</span><span class="Other">.</span><span class="Identifier">mbedtls_x509_crt</span>
  <span class="Identifier">key</span><span class="Operator">*</span><span class="Other">:</span> <span class="Identifier">mbedtls</span><span class="Other">.</span><span class="Identifier">mbedtls_pk_context</span></pre></dt>
  <dd>
    
    
    
  </dd>
</div>
<div id="X509Certificate">
  <dt><pre><a href="socket.html#X509Certificate"><span class="Identifier">X509Certificate</span></a> <span class="Other">=</span> <span class="Keyword">ptr</span> <span class="Identifier">mbedtls</span><span class="Other">.</span><span class="Identifier">mbedtls_x509_crt</span></pre></dt>
  <dd>
    
    
    
  </dd>
</div>

  </dl>
</div>
<div class="section" id="12">
  <h1><a class="toc-backref" href="#12">Procs</a></h1>
  <dl class="item">
    <div id="$-procs-all">
  <div id="$,X509Certificate">
  <dt><pre><span class="Keyword">proc</span> <a href="#%24%2CX509Certificate"><span class="Identifier">`$`</span></a><span class="Other">(</span><span class="Identifier">cert</span><span class="Other">:</span> <a href="socket.html#X509Certificate"><span class="Identifier">X509Certificate</span></a><span class="Other">)</span><span class="Other">:</span> <span class="Identifier">string</span> {.<span><span class="Other pragmadots">...</span></span><span class="pragmawrap"><span class="Identifier">raises</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span><span class="Other">,</span> <span class="Identifier">tags</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span><span class="Other">,</span> <span class="Identifier">forbids</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span></span>.}</pre></dt>
  <dd>
    
    <p>Returns a string representation of an X.509 certificate.</p>
<p>This operator allows certificate objects to be easily printed or logged. It returns a detailed, multi-line representation of the certificate including subject, issuer, validity dates, and other important fields.</p>
<p>Parameters: cert: The X.509 certificate to convert to a string</p>
<p>Returns: A formatted string containing certificate details, or &quot;(nil)&quot; if the certificate is nil</p>
<p>Example:</p>
<p><pre class="listing"><span class="Identifier">echo</span> <span class="StringLit">&quot;Certificate details:&quot;</span>
<span class="Identifier">echo</span> <span class="Identifier">response</span><span class="Operator">.</span><span class="Identifier">certificate</span></pre></p>

    
  </dd>
</div>

</div>
<div id="close-procs-all">
  <div id="close,MbedtlsSocket">
  <dt><pre><span class="Keyword">proc</span> <a href="#close%2CMbedtlsSocket"><span class="Identifier">close</span></a><span class="Other">(</span><span class="Identifier">socket</span><span class="Other">:</span> <a href="socket.html#MbedtlsSocket"><span class="Identifier">MbedtlsSocket</span></a><span class="Other">)</span> {.<span><span class="Other pragmadots">...</span></span><span class="pragmawrap"><span class="Identifier">raises</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span><span class="Other">,</span> <span class="Identifier">tags</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span><span class="Other">,</span> <span class="Identifier">forbids</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span></span>.}</pre></dt>
  <dd>
    
    
    
  </dd>
</div>

</div>
<div id="commonName-procs-all">
  <div id="commonName,X509Certificate">
  <dt><pre><span class="Keyword">proc</span> <a href="#commonName%2CX509Certificate"><span class="Identifier">commonName</span></a><span class="Other">(</span><span class="Identifier">cert</span><span class="Other">:</span> <a href="socket.html#X509Certificate"><span class="Identifier">X509Certificate</span></a><span class="Other">)</span><span class="Other">:</span> <span class="Identifier">string</span> {.<span><span class="Other pragmadots">...</span></span><span class="pragmawrap"><span class="Identifier">raises</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span><span class="Other">,</span> <span class="Identifier">tags</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span><span class="Other">,</span>
    <span class="Identifier">forbids</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span></span>.}</pre></dt>
  <dd>
    
    <p>Extracts the Common Name (CN) from an X.509 certificate.</p>
<p>This function extracts the subject Common Name from a certificate, which typically contains the domain name for server certificates or a user identifier for client certificates.</p>
<p>Parameters: cert: The X.509 certificate to extract information from</p>
<p>Returns: The Common Name string, or an empty string if no CN is found or the certificate is nil</p>
<p>Example:</p>
<p><pre class="listing"><span class="Keyword">let</span> <span class="Identifier">cn</span> <span class="Operator">=</span> <span class="Identifier">response</span><span class="Operator">.</span><span class="Identifier">certificate</span><span class="Operator">.</span><span class="Identifier">commonName</span>
<span class="Identifier">echo</span> <span class="StringLit">&quot;Server certificate is for: &quot;</span><span class="Punctuation">,</span> <span class="Identifier">cn</span></pre></p>

    
  </dd>
</div>

</div>
<div id="dial-procs-all">
  <div id="dial,string,int">
  <dt><pre><span class="Keyword">proc</span> <a href="#dial%2Cstring%2Cint"><span class="Identifier">dial</span></a><span class="Other">(</span><span class="Identifier">address</span><span class="Other">:</span> <span class="Identifier">string</span><span class="Other">;</span> <span class="Identifier">port</span><span class="Other">:</span> <span class="Identifier">int</span><span class="Other">)</span><span class="Other">:</span> <a href="socket.html#MbedtlsSocket"><span class="Identifier">MbedtlsSocket</span></a> {.<span><span class="Other pragmadots">...</span></span><span class="pragmawrap"><span class="Identifier">raises</span><span class="Other">:</span> <span class="Other">[</span><span class="Identifier">MbedtlsError</span><span class="Other">]</span><span class="Other">,</span>
    <span class="Identifier">tags</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span><span class="Other">,</span> <span class="Identifier">forbids</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span></span>.}</pre></dt>
  <dd>
    
    <p>Establishes a TCP socket connection to the specified address and port.</p>
<p>This function creates a new socket and connects it to the specified server, handling both IPv4 and IPv6 addresses. It's used as the first step in establishing a TLS connection to a Gemini server.</p>
<p>Parameters: address: The hostname or IP address to connect to port: The TCP port number to connect to (usually 1965 for Gemini)</p>
<p>Returns: A connected MbedtlsSocket</p>
<p>Raises: MbedtlsError: If the connection fails</p>
<p>Example:</p>
<p><pre class="listing"><span class="Keyword">let</span> <span class="Identifier">socket</span> <span class="Operator">=</span> <span class="Identifier">dial</span><span class="Punctuation">(</span><span class="StringLit">&quot;example.com&quot;</span><span class="Punctuation">,</span> <span class="DecNumber">1965</span><span class="Punctuation">)</span>
<span class="Comment"># The socket is now connected but not yet wrapped with TLS</span></pre></p>

    
  </dd>
</div>

</div>
<div id="fingerprint-procs-all">
  <div id="fingerprint,X509Certificate">
  <dt><pre><span class="Keyword">proc</span> <a href="#fingerprint%2CX509Certificate"><span class="Identifier">fingerprint</span></a><span class="Other">(</span><span class="Identifier">cert</span><span class="Other">:</span> <a href="socket.html#X509Certificate"><span class="Identifier">X509Certificate</span></a><span class="Other">)</span><span class="Other">:</span> <span class="Identifier">string</span> {.<span><span class="Other pragmadots">...</span></span><span class="pragmawrap"><span class="Identifier">raises</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span><span class="Other">,</span> <span class="Identifier">tags</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span><span class="Other">,</span>
    <span class="Identifier">forbids</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span></span>.}</pre></dt>
  <dd>
    
    <p>Generates a SHA-256 fingerprint of an X.509 certificate.</p>
<p>This function computes a cryptographic fingerprint of the certificate, which can be used to uniquely identify and verify certificates in a Trust-On-First-Use (TOFU) security model. The fingerprint is presented as a colon-separated hexadecimal string.</p>
<p>Parameters: cert: The X.509 certificate to fingerprint</p>
<p>Returns: SHA-256 fingerprint as a colon-separated hexadecimal string, or an empty string if the certificate is nil or hashing fails</p>
<p>Example:</p>
<p><pre class="listing"><span class="Keyword">let</span> <span class="Identifier">fp</span> <span class="Operator">=</span> <span class="Identifier">response</span><span class="Operator">.</span><span class="Identifier">certificate</span><span class="Operator">.</span><span class="Identifier">fingerprint</span>
<span class="Identifier">echo</span> <span class="StringLit">&quot;Certificate fingerprint: &quot;</span><span class="Punctuation">,</span> <span class="Identifier">fp</span>
<span class="Comment"># Save fingerprint for TOFU validation on future connections</span></pre></p>

    
  </dd>
</div>

</div>
<div id="getSslHandle-procs-all">
  <div id="getSslHandle,MbedtlsSocket">
  <dt><pre><span class="Keyword">proc</span> <a href="#getSslHandle%2CMbedtlsSocket"><span class="Identifier">getSslHandle</span></a><span class="Other">(</span><span class="Identifier">socket</span><span class="Other">:</span> <a href="socket.html#MbedtlsSocket"><span class="Identifier">MbedtlsSocket</span></a><span class="Other">)</span><span class="Other">:</span> <span class="Keyword">ptr</span> <span class="Identifier">mbedtls</span><span class="Other">.</span><span class="Identifier">mbedtls_ssl_context</span> {.
    <span><span class="Other pragmadots">...</span></span><span class="pragmawrap"><span class="Identifier">raises</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span><span class="Other">,</span> <span class="Identifier">tags</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span><span class="Other">,</span> <span class="Identifier">forbids</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span></span>.}</pre></dt>
  <dd>
    
    
    
  </dd>
</div>

</div>
<div id="handshakeAsClient-procs-all">
  <div id="handshakeAsClient,ptr.">
  <dt><pre><span class="Keyword">proc</span> <a href="#handshakeAsClient%2Cptr."><span class="Identifier">handshakeAsClient</span></a><span class="Other">(</span><span class="Identifier">sslCtx</span><span class="Other">:</span> <span class="Keyword">ptr</span> <span class="Identifier">mbedtls</span><span class="Other">.</span><span class="Identifier">mbedtls_ssl_context</span><span class="Other">)</span><span class="Other">:</span> <span class="Identifier">cint</span> {.
    <span><span class="Other pragmadots">...</span></span><span class="pragmawrap"><span class="Identifier">raises</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span><span class="Other">,</span> <span class="Identifier">tags</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span><span class="Other">,</span> <span class="Identifier">forbids</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span></span>.}</pre></dt>
  <dd>
    
    
    
  </dd>
</div>

</div>
<div id="handshakeAsServer-procs-all">
  <div id="handshakeAsServer,ptr.">
  <dt><pre><span class="Keyword">proc</span> <a href="#handshakeAsServer%2Cptr."><span class="Identifier">handshakeAsServer</span></a><span class="Other">(</span><span class="Identifier">sslCtx</span><span class="Other">:</span> <span class="Keyword">ptr</span> <span class="Identifier">mbedtls</span><span class="Other">.</span><span class="Identifier">mbedtls_ssl_context</span><span class="Other">)</span><span class="Other">:</span> <span class="Identifier">cint</span> {.
    <span><span class="Other pragmadots">...</span></span><span class="pragmawrap"><span class="Identifier">raises</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span><span class="Other">,</span> <span class="Identifier">tags</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span><span class="Other">,</span> <span class="Identifier">forbids</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span></span>.}</pre></dt>
  <dd>
    
    
    
  </dd>
</div>

</div>
<div id="isClosed2-procs-all">
  <div id="isClosed2,MbedtlsSocket">
  <dt><pre><span class="Keyword">proc</span> <a href="#isClosed2%2CMbedtlsSocket"><span class="Identifier">isClosed2</span></a><span class="Other">(</span><span class="Identifier">socket</span><span class="Other">:</span> <a href="socket.html#MbedtlsSocket"><span class="Identifier">MbedtlsSocket</span></a><span class="Other">)</span><span class="Other">:</span> <span class="Identifier">bool</span> {.<span><span class="Other pragmadots">...</span></span><span class="pragmawrap"><span class="Identifier">raises</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span><span class="Other">,</span> <span class="Identifier">tags</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span><span class="Other">,</span> <span class="Identifier">forbids</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span></span>.}</pre></dt>
  <dd>
    
    
    
  </dd>
</div>

</div>
<div id="newContext-procs-all">
  <div id="newContext">
  <dt><pre><span class="Keyword">proc</span> <a href="#newContext"><span class="Identifier">newContext</span></a><span class="Other">(</span><span class="Other">)</span><span class="Other">:</span> <a href="socket.html#MbedtlsSslContext"><span class="Identifier">MbedtlsSslContext</span></a> {.<span><span class="Other pragmadots">...</span></span><span class="pragmawrap"><span class="Identifier">raises</span><span class="Other">:</span> <span class="Other">[</span><span class="Identifier">MbedtlsError</span><span class="Other">]</span><span class="Other">,</span> <span class="Identifier">tags</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span><span class="Other">,</span>
                                       <span class="Identifier">forbids</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span></span>.}</pre></dt>
  <dd>
    
    <p>Creates a new mbedTLS SSL context with proper initialization.</p>
<p>This function creates and initializes a new SSL context with entropy, random number generation, and default configuration suitable for Gemini protocol TLS requirements. The context needs to be further configured for client or server operation before use.</p>
<p>Returns: A new initialized MbedtlsSslContext</p>
<p>Raises: MbedtlsError: If initialization of any TLS component fails</p>
<p>Example:</p>
<p><pre class="listing"><span class="Keyword">var</span> <span class="Identifier">ctx</span> <span class="Operator">=</span> <span class="Identifier">newContext</span><span class="Punctuation">(</span><span class="Punctuation">)</span>
<span class="Comment"># Further configure the context for client or server use</span></pre></p>

    
  </dd>
</div>

</div>
<div id="recv-procs-all">
  <div id="recv,MbedtlsSocket,pointer,int">
  <dt><pre><span class="Keyword">proc</span> <a href="#recv%2CMbedtlsSocket%2Cpointer%2Cint"><span class="Identifier">recv</span></a><span class="Other">(</span><span class="Identifier">socket</span><span class="Other">:</span> <a href="socket.html#MbedtlsSocket"><span class="Identifier">MbedtlsSocket</span></a><span class="Other">;</span> <span class="Identifier">data</span><span class="Other">:</span> <span class="Identifier">pointer</span><span class="Other">;</span> <span class="Identifier">size</span><span class="Other">:</span> <span class="Identifier">int</span><span class="Other">)</span><span class="Other">:</span> <span class="Identifier">int</span> {.
    <span><span class="Other pragmadots">...</span></span><span class="pragmawrap"><span class="Identifier">raises</span><span class="Other">:</span> <span class="Other">[</span><span class="Identifier">MbedtlsError</span><span class="Other">]</span><span class="Other">,</span> <span class="Identifier">tags</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span><span class="Other">,</span> <span class="Identifier">forbids</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span></span>.}</pre></dt>
  <dd>
    
    
    
  </dd>
</div>

</div>
<div id="recvLine-procs-all">
  <div id="recvLine,MbedtlsSocket">
  <dt><pre><span class="Keyword">proc</span> <a href="#recvLine%2CMbedtlsSocket"><span class="Identifier">recvLine</span></a><span class="Other">(</span><span class="Identifier">socket</span><span class="Other">:</span> <a href="socket.html#MbedtlsSocket"><span class="Identifier">MbedtlsSocket</span></a><span class="Other">)</span><span class="Other">:</span> <span class="Identifier">string</span> {.<span><span class="Other pragmadots">...</span></span><span class="pragmawrap"><span class="Identifier">raises</span><span class="Other">:</span> <span class="Other">[</span><span class="Identifier">MbedtlsError</span><span class="Other">]</span><span class="Other">,</span> <span class="Identifier">tags</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span><span class="Other">,</span>
    <span class="Identifier">forbids</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span></span>.}</pre></dt>
  <dd>
    
    
    
  </dd>
</div>

</div>
<div id="send-procs-all">
  <div id="send,MbedtlsSocket,pointer,int">
  <dt><pre><span class="Keyword">proc</span> <a href="#send%2CMbedtlsSocket%2Cpointer%2Cint"><span class="Identifier">send</span></a><span class="Other">(</span><span class="Identifier">socket</span><span class="Other">:</span> <a href="socket.html#MbedtlsSocket"><span class="Identifier">MbedtlsSocket</span></a><span class="Other">;</span> <span class="Identifier">data</span><span class="Other">:</span> <span class="Identifier">pointer</span><span class="Other">;</span> <span class="Identifier">size</span><span class="Other">:</span> <span class="Identifier">int</span><span class="Other">)</span><span class="Other">:</span> <span class="Identifier">int</span> {.
    <span><span class="Other pragmadots">...</span></span><span class="pragmawrap"><span class="Identifier">raises</span><span class="Other">:</span> <span class="Other">[</span><span class="Identifier">MbedtlsError</span><span class="Other">]</span><span class="Other">,</span> <span class="Identifier">tags</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span><span class="Other">,</span> <span class="Identifier">forbids</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span></span>.}</pre></dt>
  <dd>
    
    <p>Sends data over a TLS-encrypted connection.</p>
<p>This function sends the specified data over a TLS-encrypted socket connection. It handles the encryption transparently through mbedTLS.</p>
<p>Parameters: socket: The TLS socket to send data through data: Pointer to the buffer containing the data to send size: Number of bytes to send</p>
<p>Returns: The number of bytes successfully sent</p>
<p>Raises: MbedtlsError: If the send operation fails or the socket is invalid</p>
<p>Note: This function blocks until the data is sent or an error occurs. It may send fewer bytes than requested, so check the return value.</p>

    
  </dd>
</div>
<div id="send,MbedtlsSocket,string">
  <dt><pre><span class="Keyword">proc</span> <a href="#send%2CMbedtlsSocket%2Cstring"><span class="Identifier">send</span></a><span class="Other">(</span><span class="Identifier">socket</span><span class="Other">:</span> <a href="socket.html#MbedtlsSocket"><span class="Identifier">MbedtlsSocket</span></a><span class="Other">;</span> <span class="Identifier">data</span><span class="Other">:</span> <span class="Identifier">string</span><span class="Other">)</span><span class="Other">:</span> <span class="Identifier">int</span> {.<span><span class="Other pragmadots">...</span></span><span class="pragmawrap"><span class="Identifier">raises</span><span class="Other">:</span> <span class="Other">[</span><span class="Identifier">MbedtlsError</span><span class="Other">]</span><span class="Other">,</span>
    <span class="Identifier">tags</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span><span class="Other">,</span> <span class="Identifier">forbids</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span></span>.}</pre></dt>
  <dd>
    
    <p>Sends a string over a TLS-encrypted connection.</p>
<p>This is a convenience overload that allows sending a string directly without manually handling pointers. It transparently handles the encryption through mbedTLS.</p>
<p>Parameters: socket: The TLS socket to send data through data: The string to send</p>
<p>Returns: The number of bytes successfully sent</p>
<p>Raises: MbedtlsError: If the send operation fails or the socket is invalid</p>
<p>Example:</p>
<p><pre class="listing"><span class="Keyword">let</span> <span class="Identifier">bytesWritten</span> <span class="Operator">=</span> <span class="Identifier">socket</span><span class="Operator">.</span><span class="Identifier">send</span><span class="Punctuation">(</span><span class="StringLit">&quot;GET / HTTP/1.1</span><span class="EscapeSequence">\r</span><span class="EscapeSequence">\n</span><span class="StringLit">Host: example.com</span><span class="EscapeSequence">\r</span><span class="EscapeSequence">\n</span><span class="EscapeSequence">\r</span><span class="EscapeSequence">\n</span><span class="StringLit">&quot;</span><span class="Punctuation">)</span></pre></p>

    
  </dd>
</div>

</div>
<div id="setCustomVerify-procs-all">
  <div id="setCustomVerify,MbedtlsSslContext">
  <dt><pre><span class="Keyword">proc</span> <a href="#setCustomVerify%2CMbedtlsSslContext"><span class="Identifier">setCustomVerify</span></a><span class="Other">(</span><span class="Identifier">context</span><span class="Other">:</span> <a href="socket.html#MbedtlsSslContext"><span class="Identifier">MbedtlsSslContext</span></a><span class="Other">)</span> {.<span><span class="Other pragmadots">...</span></span><span class="pragmawrap"><span class="Identifier">raises</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span><span class="Other">,</span> <span class="Identifier">tags</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span><span class="Other">,</span>
    <span class="Identifier">forbids</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span></span>.}</pre></dt>
  <dd>
    
    <p>Configures the mbedTLS context to use a custom certificate verification callback.</p>
<p>This function sets up a certificate verification callback that implements the Trust-On-First-Use (TOFU) model for Gemini. It accepts self-signed certificates while still validating other aspects of certificate security.</p>
<p>Parameters: context: The mbedTLS SSL context to configure</p>
<p>Note: This is crucial for the Gemini protocol's security model, which encourages the use of self-signed certificates.</p>

    
  </dd>
</div>

</div>
<div id="setMinVersion-procs-all">
  <div id="setMinVersion,MbedtlsSslContext,">
  <dt><pre><span class="Keyword">proc</span> <a href="#setMinVersion%2CMbedtlsSslContext%2C"><span class="Identifier">setMinVersion</span></a><span class="Other">(</span><span class="Identifier">context</span><span class="Other">:</span> <a href="socket.html#MbedtlsSslContext"><span class="Identifier">MbedtlsSslContext</span></a><span class="Other">;</span> <span class="Identifier">version</span><span class="Other">:</span> <span class="Identifier">mbedtls</span><span class="Other">.</span><span class="Identifier">TlsVersion</span><span class="Other">)</span><span class="Other">:</span> <span class="Identifier">bool</span> {.
    <span><span class="Other pragmadots">...</span></span><span class="pragmawrap"><span class="Identifier">raises</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span><span class="Other">,</span> <span class="Identifier">tags</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span><span class="Other">,</span> <span class="Identifier">forbids</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span></span>.}</pre></dt>
  <dd>
    
    <p>Sets the minimum TLS version for a context.</p>
<p>This function configures the minimum TLS protocol version that will be accepted during the handshake. For Gemini protocol compliance, this should be at least TLS 1.2 (TLS_V12).</p>
<p>Parameters: context: The mbedTLS SSL context to configure version: The minimum TLS version to allow</p>
<p>Returns: true if the version was successfully set, false otherwise</p>
<p>Example:</p>
<p><pre class="listing"><span class="Keyword">var</span> <span class="Identifier">ctx</span> <span class="Operator">=</span> <span class="Identifier">newContext</span><span class="Punctuation">(</span><span class="Punctuation">)</span>
<span class="Keyword">discard</span> <span class="Identifier">ctx</span><span class="Operator">.</span><span class="Identifier">setMinVersion</span><span class="Punctuation">(</span><span class="Identifier">TLS_V12</span><span class="Punctuation">)</span>  <span class="Comment"># Set minimum to TLS 1.2</span></pre></p>

    
  </dd>
</div>

</div>
<div id="wrapConnectedSocket-procs-all">
  <div id="wrapConnectedSocket,MbedtlsSslContext,MbedtlsSocket,proc(ptr.),string">
  <dt><pre><span class="Keyword">proc</span> <a href="#wrapConnectedSocket%2CMbedtlsSslContext%2CMbedtlsSocket%2Cproc%28ptr.%29%2Cstring"><span class="Identifier">wrapConnectedSocket</span></a><span class="Other">(</span><span class="Identifier">context</span><span class="Other">:</span> <a href="socket.html#MbedtlsSslContext"><span class="Identifier">MbedtlsSslContext</span></a><span class="Other">;</span> <span class="Identifier">socket</span><span class="Other">:</span> <a href="socket.html#MbedtlsSocket"><span class="Identifier">MbedtlsSocket</span></a><span class="Other">;</span>
    <span class="Identifier">handshakeFunc</span><span class="Other">:</span> <span class="Keyword">proc</span> <span class="Other">(</span><span class="Identifier">sslCtx</span><span class="Other">:</span> <span class="Keyword">ptr</span> <span class="Identifier">mbedtls</span><span class="Other">.</span><span class="Identifier">mbedtls_ssl_context</span><span class="Other">)</span><span class="Other">:</span> <span class="Identifier">cint</span><span class="Other">;</span>
                         <span class="Identifier">hostname</span><span class="Other">:</span> <span class="Identifier">string</span><span class="Other">)</span> {.<span><span class="Other pragmadots">...</span></span><span class="pragmawrap"><span class="Identifier">raises</span><span class="Other">:</span> <span class="Other">[</span><span class="Identifier">MbedtlsError</span><span class="Other">,</span> <span class="Identifier">Exception</span><span class="Other">]</span><span class="Other">,</span>
    <span class="Identifier">tags</span><span class="Other">:</span> <span class="Other">[</span><span class="Identifier">RootEffect</span><span class="Other">]</span><span class="Other">,</span> <span class="Identifier">forbids</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span></span>.}</pre></dt>
  <dd>
    
    
    
  </dd>
</div>
<div id="wrapConnectedSocket,MbedtlsSslContext,MbedtlsSocketObj,proc(ptr.),string">
  <dt><pre><span class="Keyword">proc</span> <a href="#wrapConnectedSocket%2CMbedtlsSslContext%2CMbedtlsSocketObj%2Cproc%28ptr.%29%2Cstring"><span class="Identifier">wrapConnectedSocket</span></a><span class="Other">(</span><span class="Identifier">context</span><span class="Other">:</span> <a href="socket.html#MbedtlsSslContext"><span class="Identifier">MbedtlsSslContext</span></a><span class="Other">;</span>
                         <span class="Identifier">socket</span><span class="Other">:</span> <span class="Keyword">var</span> <a href="socket.html#MbedtlsSocketObj"><span class="Identifier">MbedtlsSocketObj</span></a><span class="Other">;</span> <span class="Identifier">handshakeFunc</span><span class="Other">:</span> <span class="Keyword">proc</span> <span class="Other">(</span>
    <span class="Identifier">sslCtx</span><span class="Other">:</span> <span class="Keyword">ptr</span> <span class="Identifier">mbedtls</span><span class="Other">.</span><span class="Identifier">mbedtls_ssl_context</span><span class="Other">)</span><span class="Other">:</span> <span class="Identifier">cint</span><span class="Other">;</span> <span class="Identifier">hostname</span><span class="Other">:</span> <span class="Identifier">string</span><span class="Other">)</span> {.
    <span><span class="Other pragmadots">...</span></span><span class="pragmawrap"><span class="Identifier">raises</span><span class="Other">:</span> <span class="Other">[</span><span class="Identifier">MbedtlsError</span><span class="Other">,</span> <span class="Identifier">Exception</span><span class="Other">]</span><span class="Other">,</span> <span class="Identifier">tags</span><span class="Other">:</span> <span class="Other">[</span><span class="Identifier">RootEffect</span><span class="Other">]</span><span class="Other">,</span> <span class="Identifier">forbids</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span></span>.}</pre></dt>
  <dd>
    
    <p>Sets up TLS on an existing socket connection and performs handshake.</p>
<p>This function initializes a TLS session on top of an already connected socket. It configures the TLS context with the specified hostname for SNI (Server Name Indication), sets up the I/O callbacks, and performs the TLS handshake.</p>
<p>Parameters: context: The SSL context to use for the TLS session socket: The socket object to wrap with TLS handshakeFunc: A function that performs either client or server handshake hostname: The server hostname for SNI (Server Name Indication)</p>
<p>Raises: MbedtlsError: If the TLS setup or handshake fails</p>
<p>Note: This function is used internally by both client and server implementations. For self-signed certificates, verification failures with specific error codes are accepted to support the Gemini protocol's security model.</p>

    
  </dd>
</div>

</div>

  </dl>
</div>

  </div>
</div>

      <div class="twelve-columns footer">
        <span class="nim-sprite"></span>
        <br>
        <small style="color: var(--hint);">Made with Nim. Generated: 2025-03-20 23:33:22 UTC</small>
      </div>
    </div>
  </div>
  
</body>
</html>
